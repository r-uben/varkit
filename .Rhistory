library(QR)
install.packages("QR")
library(QR)
M.j <- matrix(c(0, 0, 0, 0, 0, 0, 0,   # Row 1
0, 0, 0, 0, 0, 0, 0,   # Row 2
0, 0, 0.7871478, 0.1978098, 0.4109216, -0.383821, -0.1584128),  # Row 3
nrow = 3, ncol = 7, byrow = TRUE)
# Use the QR package function
qr_result <- QR(t(M.j))
# Extract the Q matrix
qr_result$Q
install.packages("QR")
library(QR)
M.j <- matrix(c(0, 0, 0, 0, 0, 0, 0,   # Row 1
0, 0, 0, 0, 0, 0, 0,   # Row 2
0, 0, 0.7871478, 0.1978098, 0.4109216, -0.383821, -0.1584128),  # Row 3
nrow = 3, ncol = 7, byrow = TRUE)
# Use the QR package function
qr_result <- QR(t(M.j), complete=T)
# Extract the Q matrix
qr_result$Q
library(QR)
M.j <- matrix(c(0, 0, 0, 0, 0, 0, 0,   # Row 1
0, 0, 0, 0, 0, 0, 0,   # Row 2
0, 0, 0.7871478, 0.1978098, 0.4109216, -0.383821, -0.1584128),  # Row 3
nrow = 3, ncol = 7, byrow = TRUE)
# Use the QR package function
qr_result <- QR(t(M.j), complete=T)
# Extract the Q matrix
qr_result$Q
qr_result <- QR(t(M.j), complete=TRUE)
# Extract the Q matrix
qr_result$Q
library(QR)
M.j <- matrix(c(0, 0, 0, 0, 0, 0, 0,   # Row 1
0, 0, 0, 0, 0, 0, 0,   # Row 2
0, 0, 0.7871478, 0.1978098, 0.4109216, -0.383821, -0.1584128),  # Row 3
nrow = 3, ncol = 7, byrow = TRUE)
# Use the QR package function
# Compute QR decomposition without pivoting
result <- QR(A)
# Use the QR package function
result <- QR(t(M.j), complete=TRUE)
# Extract economy-size Q (7x3) and R (3x3)
Q_economy <- result$Q
R <- result$R
# Compute the complete Q (7x7)
# Step 1: Find an orthonormal basis for the null space of A^T (3x7)
# Use svd or qr on null space vectors to get remaining columns
null_basis <- qr.Q(qr(t(A)), complete=TRUE)[, 4:7]  # Get last 4 columns for null space (7x4)
ibrary(QR)
library(QR)
M.j <- matrix(c(0, 0, 0, 0, 0, 0, 0,   # Row 1
0, 0, 0, 0, 0, 0, 0,   # Row 2
0, 0, 0.7871478, 0.1978098, 0.4109216, -0.383821, -0.1584128),  # Row 3
nrow = 3, ncol = 7, byrow = TRUE)
# Use the QR package function
result <- QR(t(M.j), complete=TRUE)
# Extract economy-size Q (7x3) and R (3x3)
Q_economy <- result$Q
R <- result$R
# Compute the complete Q (7x7)
# Step 1: Find an orthonormal basis for the null space of A^T (3x7)
# Use svd or qr on null space vectors to get remaining columns
null_basis <- qr.Q(qr(t(M.j)), complete=TRUE)[, 4:7]  # Get last 4 columns for null space (7x4)
# Step 2: Combine economy Q with null space basis
Q_complete <- cbind(Q_economy, null_basis)
# Verify orthogonality (Q_complete^T * Q_complete should be identity)
is_orthogonal <- all.equal(t(Q_complete) %*% Q_complete, diag(7))
print(is_orthogonal)  # Should print TRUE
Q_complete
